#Remove outgroup (G. wheatlandi) from polarized vcf.
bcftools view -s SRR15009118 ML_autosomes.aa.vcf -o for_dadi_synon_auto_aa.vcf 

#Generate frequency spectrum from polarized vcf
dadi-cli GenerateFs --vcf for_dadi_synon_auto_aa.vcf --pop-info pops.txt --pop-ids CB CL --projections 20 20 --output for_dadi_synon_auto_aa.fs

#Infer demographic modls from allele frequncy spectrum and obtain best fit parameters
#Ancestral Asymmetric Migration model 
dadi-cli BestFit --input-prefix CB_CL.anc_asym_mig.demog.params.InferDM --lbounds 1e-3 1e-3 0 0 0 0 0 --ubounds 5 5 12 12 10 10 .5
dadi-cli InferDM --fs for_dadi_synon_auto_aa.fs --model anc_asym_mig --lbounds 1e-3 1e-3 0 0 0 0 0 --ubounds 5 5 12 12 10 10 .5 --output CB_CL.anc_asym_mig.demog.params --optimizations 200 --global-optimization

#Ancestral Symmetric Migration
# dadi-cli BestFit --input-prefix CB_CL.anc_sym_mig.demog.params.InferDM --lbounds 1e-3 1e-3 0 0 0 0 --ubounds 5 10 12 10 10 .5
# dadi-cli InferDM --fs for_dadi_synon_auto_aa.fs --model anc_sym_mig --lbounds 1e-3 1e-3 0 0 0 0 --ubounds 5 10 12 10 10 .5 --output CB_CL.anc_sym_mig.demog.params --optimizations 200 --global-optimization

#Asymmetric Migration
dadi-cli BestFit --input-prefix CB_CL.asym_mig.demog.params.InferDM --lbounds 1e-3 1e-3 0 0 0 0 --ubounds 5 7 12 15 10 .5
dadi-cli InferDM --fs for_dadi_synon_auto_aa.fs --model asym_mig --lbounds 1e-3 1e-3 0 0 0 0 --ubounds 5 7 12 15 10 .5 --output CB_CL.asym_mig.demog.params --optimizations 200 --global-optimization

#

